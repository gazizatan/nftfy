<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="icon" href="./assets/logo.png">
    <title>NFTify</title>
    <link rel="stylesheet" href="css/playlist.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
</head>
<body>
    <div class="main">
        <div class="hover-area"></div>
        <div class="sidebar">
            <div class="nav">
                <div class="nav-option" style="opacity: 1;">
                    <i class="fa-solid fa-house"></i><!-- Home -->
                    <a href="#">Home</a>
                </div>
                <div class="nav-option">
                    <i class="fa-solid fa-magnifying-glass"></i><!-- search option -->
                    <a href="#">Search</a>
                </div>
            </div>
            <div class="library">
                <div class="options">
                    <div class="lib-option nav-option ">
                        <i class="fa-solid fa-list"></i><!-- libarary -->
                        <a href="#">Your Library</a>
                    </div>
                    <div class="icons">
                        <i class="fa-solid fa-plus"></i> <!-- plus symbole -->
                        <i class="fa-solid fa-arrow-left fa-flip-horizontal"></i>
                    </div>
                </div>
                <div class="lib-box">
                    <div class="box"><!-- slidebar first box -->
                        <p class="box-p1">Create your first playlist</p>
                        <p class="box-p2">It's easy, we'll help you</p>
                        <button class="badge">Create playlist</button>
                    </div>
                    <div class="box"><!-- slidebar second box -->
                        <p class="box-p1">Let's find some podcasts to follow</p>
                        <p class="box-p2">We'll keep you updated on new episodes</p>
                        <button class="badge">Browse podcasts</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- main contain started  -->
        <div class="main-content">
            <div class="sticky-nav">
                <div class="sticky-nav-icons">
                    <div class="group">
                        <div class="nav-option">
                        <a href="index.html">
                            <i class="fa-solid fa-house"></i><!-- Home -->
                        </a>
                        </div>
                        <i class="fa-solid fa-magnifying-glass"></i><!-- search option -->
                        <input
                            id="query"
                            class="input"
                            type="search"
                            placeholder="Search..."
                            name="searchbar"
                        />
                    </div>
                </div>
                <div class="sticky-nav-option">
                    <button class="badge nav-items" id="uploadMusicButton">+ Upload Music</button>
                    <div id="uploadMusicForm" style="display: none;">
                        <span class="close-button">&times;</span>
                        <form id="musicForm">
                            <h2>Upload Music</h2>
                            <label for="title">Title:</label>
                            <input type="text" id="title" name="title" required><br>
                            <label for="artist">Artist:</label>
                            <input type="text" id="artist" name="artist" required><br>
                            <label for="price">Price (in ETH):</label>
                            <input type="number" id="price" name="price" required><br>
                            <label for="musicFile">Music File:</label>
                            <input type="file" id="musicFile" name="musicFile" accept="audio/*" required><br>
                            <button type="submit">Submit</button>
                        </form>
                    </div>
                    <a href="login.html">
                        <button class="badge nav-items dark-badge" style="color:white">Sign Up</button>
                    </a>
                    <i class="fa-regular fa-user nav-items"></i> <!-- user icon  -->
                    <div id="profilePopup" class="profile-popup">
                        <div class="profile-content">
                            <span id="closeProfile" class="close">&times;</span>
                            <h3>Account Info</h3>
                            <img id="profileImage" src="default-avatar.png" alt="Profile Picture">
                            <p id="profileName">Username</p>
                            <p id="walletAddress">Wallet: Not connected</p>
                            <button id="logoutButton">Logout</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main-container">
                <div class="scroll-container">
                  <div class="scroll-viewport">
                    <div class="content">
                      <main class="playlist" aria-label="Скачанные - playlist by ">
                        <section class="playlist-header">
                          <div class="playlist-image">
                            <img src="assets/90s.jpeg" alt="Playlist name">
                          </div>
                          <div class="playlist-info">
                            <h1>90's Song</h1>
                            <div class="creator-info">
                                <img id="profileImage" src="default-avatar.png" alt="Profile Picture">
                              <span></span>
                            </div>
                            <div class="playlist-stats">
                              <span>1 159 треков</span>
                              <span>более 24 ч.</span>
                            </div>
                          </div>
                        </section>
                        <div class="action-bar">
                          <button aria-label="Слушать плейлист «Скачанные»">Слушать</button>
                          <button aria-label="Открыть контекстное меню">...</button>
                        </div>
                        <div class="tracklist">
                          <div class="tracklist-header">
                            <span>#</span>
                            <span>Название</span>
                            <span>Альбом</span>
                            <span>Дата добавления</span>
                            <span>Длительность</span>
                            <span>Купить</span>
                          </div>
                          <div class="tracklist-body">
                            <div class="track">
                                <span>1</span>
                                <img src="https://i.scdn.co/image/ab67616d00004851121d5f92cf90576907dfb1e5" alt="Pumped Up Kicks">
                                <span>Pumped Up Kicks</span>
                                <span>Foster The People</span>
                                <span>1 день назад</span>
                                <span>3:45</span>
                                <span>
                                    <button class="buy-button">Buy</button>
                                    <div class="buy-form" style="display: none;">
                                        <h3>Купить трек?</h3>
                                        <p>Вы действительно хотите купить этот трек?</p>
                                        <button class="confirm-buy">Да</button>
                                        <button class="cancel-buy">Нет</button>
                                    </div>
                                </span>
                            <div class="tracklist-body">
                                <div class="track">
                                  <span>2</span>
                                  <img src="https://i.scdn.co/image/ab67616d00004851121d5f92cf90576907dfb1e5" alt="Pumped Up Kicks">
                                  <span>Pumped Up Kicks</span>
                                  <span>Foster The People</span>
                                  <span>1 день назад</span>
                                  <span>3:45</span>
                                  <span>Купить</span>
                                </div>
                                <div class="tracklist-body">
                                    <div class="track">
                                      <span>1</span>
                                      <img src="https://i.scdn.co/image/ab67616d00004851121d5f92cf90576907dfb1e5" alt="Pumped Up Kicks">
                                      <span>Pumped Up Kicks</span>
                                      <span>Foster The People</span>
                                      <span>1 день назад</span>
                                      <span>3:45</span>
                                      <span>Купить</span>
                                    </div>
                                <div class="tracklist-body">
                                    <div class="track">
                                        <span>2</span>
                                        <img src="https://i.scdn.co/image/ab67616d00004851121d5f92cf90576907dfb1e5" alt="Pumped Up Kicks">
                                        <span>Pumped Up Kicks</span>
                                        <span>Foster The People</span>
                                        <span>1 день назад</span>
                                        <span>3:45</span>
                                        <span>Купить</span>
                                        </div>   
                            <!-- Другие треки могут быть добавлены здесь -->
                          </div>
                        </div>
                      </main>
                    </div>
                  </div>
                </div>
              </div>

            <div class="music-player">
                <audio id="audioElement" controls>
                    Your browser does not support the audio element.
                </audio>
            </div>
        </div>
    </div>
    <script type="module" src="web3Setup.js"></script>
    <script type="module" src="js/musicPlayer.js"></script>
    <script type="module" src="js/playlist.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const musicImages = document.querySelectorAll(".music-img");
            const audioPlayer = document.getElementById("audioPlayer");
            
            musicImages.forEach(img => {
                img.addEventListener("click", function () {
                    const songFile = img.getAttribute("data-src");
                    if (songFile) {
                        audioPlayer.src = `api/music/${encodeURIComponent(songFile)}`;
                        audioPlayer.play();
                    }
                });
            });
        });
    </script>